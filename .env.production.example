# =============================================================================
# Personal Network CRM - Production Environment Variables
# =============================================================================
#
# This file contains all environment variables needed for production deployment.
# Copy this file and fill in the actual values for your deployment.
#
# Variables are separated by service (Backend vs Frontend) for easier
# configuration in containerized deployments (e.g., Coolify, Docker, K8s).
#

# #############################################################################
#                              BACKEND SERVICE
# #############################################################################

# =============================================================================
# DATABASE (Required)
# =============================================================================

# PostgreSQL connection URL
# For production, use a connection pooler like PgBouncer
DATABASE_URL="postgresql://pmcrm_user:YOUR_PASSWORD@your-db-host:5432/pmcrm?schema=public&connection_limit=20&pool_timeout=10"

# Redis connection URL (for BullMQ queues and caching)
REDIS_URL="redis://your-redis-host:6379"

# =============================================================================
# APPLICATION (Required)
# =============================================================================

NODE_ENV="production"
PORT=3001

# Frontend URL - CRITICAL for CORS and better-auth trusted origins
# This must match the exact URL where your frontend is deployed
FRONTEND_URL="https://your-frontend-domain.com"

# =============================================================================
# BETTER AUTH (Required)
# =============================================================================

# Secret key for signing tokens and cookies
# Generate with: openssl rand -base64 32
BETTER_AUTH_SECRET="YOUR_BETTER_AUTH_SECRET_HERE"

# Base URL for better-auth callbacks (backend URL)
# This is where OAuth providers will redirect after authentication
BETTER_AUTH_URL="https://your-backend-domain.com"

# =============================================================================
# OAUTH PROVIDERS (Optional - enable as needed)
# =============================================================================

# Google OAuth (for Google Sign-in and Google Contacts/Calendar integration)
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""

# Microsoft OAuth (for Microsoft Sign-in and Outlook/Calendar integration)
MICROSOFT_CLIENT_ID=""
MICROSOFT_CLIENT_SECRET=""
MICROSOFT_TENANT_ID="common"

# LinkedIn OAuth (for profile enrichment)
LINKEDIN_CLIENT_ID=""
LINKEDIN_CLIENT_SECRET=""

# =============================================================================
# AI/LLM CONFIGURATION (Optional)
# =============================================================================

# AI Provider: 'google' | 'openai' | 'anthropic'
AI_PROVIDER="google"

# Model name (provider-specific)
# Google: 'gemini-2.5-flash'
# OpenAI: 'gpt-4o'
# Anthropic: 'claude-3-5-sonnet'
AI_MODEL="gemini-2.5-flash"

# API Keys (only one needed based on AI_PROVIDER)
GOOGLE_AI_API_KEY=""
OPENAI_API_KEY=""
ANTHROPIC_API_KEY=""

# =============================================================================
# SECURITY (Optional)
# =============================================================================

# OAuth Token Encryption Key (for storing refresh tokens securely)
# Generate with: openssl rand -hex 32
OAUTH_ENCRYPTION_KEY="YOUR_OAUTH_ENCRYPTION_KEY_HERE"

# CORS allowed origins (comma-separated, in addition to FRONTEND_URL)
ALLOWED_ORIGINS="https://your-frontend-domain.com"

# Rate limiting
RATE_LIMIT_TTL=60
RATE_LIMIT_MAX=100

# =============================================================================
# LOGGING & DEBUGGING (Optional)
# =============================================================================

LOG_LEVEL="info"

# Disable Swagger in production for security
ENABLE_SWAGGER=false

# =============================================================================
# MONITORING (Optional)
# =============================================================================

SENTRY_DSN=""
SENTRY_ENVIRONMENT="production"


# #############################################################################
#                             FRONTEND SERVICE
# #############################################################################

# =============================================================================
# API CONFIGURATION (Required)
# =============================================================================

# Backend API URL - where the NestJS backend is deployed
NEXT_PUBLIC_API_URL="https://your-backend-domain.com"

# Backend Auth URL - same as API URL for better-auth endpoints
# This is used by the better-auth client to make auth requests
NEXT_PUBLIC_AUTH_URL="https://your-backend-domain.com"

# =============================================================================
# API VERSION (Optional)
# =============================================================================

# API version path (default: api/v1)
NEXT_PUBLIC_API_VERSION="api/v1"

# =============================================================================
# AUTH TOKEN STORAGE (Optional)
# =============================================================================

# Local storage keys for auth tokens (change if needed for security)
NEXT_PUBLIC_AUTH_TOKEN_KEY="pmcrm_auth_token"
NEXT_PUBLIC_REFRESH_TOKEN_KEY="pmcrm_refresh_token"

# =============================================================================
# MONITORING (Optional)
# =============================================================================

NEXT_PUBLIC_SENTRY_DSN=""


# #############################################################################
#                         DEPLOYMENT CHECKLIST
# #############################################################################
#
# Before deploying, ensure you have:
#
# 1. ✅ Set DATABASE_URL to your production PostgreSQL instance
# 2. ✅ Set REDIS_URL to your production Redis instance
# 3. ✅ Generated and set BETTER_AUTH_SECRET (openssl rand -base64 32)
# 4. ✅ Set BETTER_AUTH_URL to your backend's public URL
# 5. ✅ Set FRONTEND_URL to your frontend's public URL (critical for CORS!)
# 6. ✅ Set NEXT_PUBLIC_API_URL and NEXT_PUBLIC_AUTH_URL to backend URL
# 7. ✅ Configured OAuth providers if using social login
# 8. ✅ Set AI provider API key if using AI features
#
# Common Issues:
# - "INVALID_ORIGIN" error: FRONTEND_URL doesn't match the actual frontend URL
# - 404 on /api/auth/*: NEXT_PUBLIC_AUTH_URL is wrong or missing
# - OAuth callback errors: BETTER_AUTH_URL doesn't match OAuth redirect URIs
#
